<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap');

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f0e4d7;
            color: #5d4037;
            opacity: 0;
            animation: fadeInPage 0.5s ease-in forwards;
            overflow-x: hidden;
        }

        @keyframes fadeInPage {
            to { opacity: 1; }
        }

        .farm-card {
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
            border: 4px solid #d7ccc8;
            animation: cardSlideIn 0.4s ease-out backwards;
        }

        @keyframes cardSlideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .farm-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            border-color: #8d6e63;
        }

        #modal, #sub-modal {
            display: none; 
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.75);
            z-index: 100;
            backdrop-filter: blur(4px);
            align-items: center;
            justify-content: center;
            padding: 10px;
        }

        #sub-modal { z-index: 110; background: rgba(0,0,0,0.5); }

        .modal-content {
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.9);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            -webkit-overflow-scrolling: touch;
        }

        .modal.active .modal-content {
            transform: scale(1);
            opacity: 1;
        }

        .item-row {
            border-bottom: 1px solid #f3e8df;
        }

        .item-row:last-child {
            border-bottom: none;
        }

        .stat-badge {
            display: inline-flex;
            align-items: center;
            padding: 2px 8px;
            border-radius: 9999px;
            font-size: 0.7rem;
            font-weight: bold;
            margin: 2px;
            white-space: nowrap;
        }

        @media (min-width: 640px) {
            .stat-badge { font-size: 0.75rem; }
        }

        .badge-lvl { background: #e1f5fe; color: #0288d1; }
        .badge-coin { background: #fff9c4; color: #fbc02d; }
        .badge-time { background: #efebe9; color: #5d4037; }
        .badge-star { background: #fff3e0; color: #ef6c00; }
        .badge-extra { background: #f3e5f5; color: #7b1fa2; }
        
        .ingredient {
            font-size: 0.75rem;
            background: #f1f8e9;
            color: #33691e;
            padding: 4px 10px;
            border-radius: 8px;
            margin: 3px;
            display: inline-block;
            cursor: pointer;
            border: 1px solid #dcedc8;
            transition: all 0.2s;
            touch-action: manipulation;
        }

        .ingredient:hover {
            background: #dcedc8;
            transform: scale(1.05);
        }

        #search-input:focus {
            outline: none;
            border-color: #8d6e63;
            box-shadow: 0 0 0 3px rgba(141, 110, 99, 0.2);
        }

        .lang-btn {
            padding: 6px 14px;
            border-radius: 10px;
            font-weight: bold;
            transition: all 0.2s;
            border: 2px solid transparent;
            font-size: 0.85rem;
        }

        .lang-btn.active {
            background: #8d6e63;
            color: white;
            border-color: #5d4037;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —è–∑—ã–∫–æ–≤ -->
    <div class="fixed top-4 right-4 z-[120] bg-white/90 backdrop-blur p-1 rounded-xl shadow-lg flex gap-1 border-2 border-amber-100">
        <button onclick="changeLang('ru')" id="btn-ru" class="lang-btn active">RU</button>
        <button onclick="changeLang('en')" id="btn-en" class="lang-btn">EN</button>
        <button onclick="changeLang('uk')" id="btn-uk" class="lang-btn">UA</button>
    </div>

    <header class="text-center mb-6 pt-12 md:pt-0">
        <h1 id="ui-title" class="text-3xl md:text-4xl font-black text-amber-900 mb-2 uppercase tracking-tighter">–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –§–µ—Ä–º–µ—Ä–∞</h1>
        <p id="ui-subtitle" class="text-amber-700 text-sm md:text-base">–í—Å–µ —Ä–µ—Ü–µ–ø—Ç—ã –∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ</p>
    </header>

    <div class="max-w-md mx-auto mb-8 relative px-2">
        <input 
            type="text" 
            id="search-input" 
            placeholder="–ü–æ–∏—Å–∫ –∑–¥–∞–Ω–∏—è –∏–ª–∏ —Ç–æ–≤–∞—Ä–∞..." 
            class="w-full p-4 pl-12 rounded-2xl border-2 border-amber-200 bg-white shadow-sm transition-all text-sm md:text-base"
            oninput="handleSearch()"
        >
        <div class="absolute left-6 top-1/2 -translate-y-1/2 text-amber-400">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
        </div>
    </div>

    <div id="buildings-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6"></div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–¥–∞–Ω–∏—è -->
    <div id="modal" class="modal" onclick="closeModal(event)">
        <div class="modal-content bg-white max-w-2xl rounded-3xl shadow-2xl p-4 md:p-8 relative" onclick="event.stopPropagation()">
            <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 text-3xl font-bold p-2">&times;</button>
            <div id="modal-body"></div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞ -->
    <div id="sub-modal" class="modal" onclick="closeSubModal()">
        <div class="modal-content bg-amber-50 max-w-xs rounded-3xl shadow-2xl p-6 relative text-center border-4 border-white" onclick="event.stopPropagation()">
            <div id="sub-modal-body"></div>
        </div>
    </div>

    <script>
        let currentLang = 'ru';

        const i18n = {
            ru: {
                title: "–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –§–µ—Ä–º–µ—Ä–∞",
                subtitle: "–í—Å–µ —Ä–µ—Ü–µ–ø—Ç—ã –∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ",
                search: "–ü–æ–∏—Å–∫ –∑–¥–∞–Ω–∏—è –∏–ª–∏ —Ç–æ–≤–∞—Ä–∞...",
                lvl: "–£—Ä.",
                price: "–¶–µ–Ω–∞",
                build: "–ü–æ—Å—Ç—Ä–æ–π–∫–∞",
                exp: "–û–ø—ã—Ç",
                time: "–í—Ä–µ–º—è",
                extra: "–ò–Ω—Ñ–æ",
                empty: "–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ üöú",
                close: "–û–ö",
                products: "–ü—Ä–æ–¥—É–∫—Ü–∏—è",
                ing_details: "–î–µ—Ç–∞–ª–∏ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞"
            },
            en: {
                title: "Farmer's Handbook",
                subtitle: "All recipes and production in one place",
                search: "Search building or item...",
                lvl: "Lvl.",
                price: "Price",
                build: "Build",
                exp: "Exp",
                time: "Time",
                extra: "Info",
                empty: "Nothing found üöú",
                close: "OK",
                products: "Products",
                ing_details: "Ingredient Details"
            },
            uk: {
                title: "–î–æ–≤—ñ–¥–Ω–∏–∫ –§–µ—Ä–º–µ—Ä–∞",
                subtitle: "–í—Å—ñ —Ä–µ—Ü–µ–ø—Ç–∏ —Ç–∞ –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ –≤ –æ–¥–Ω–æ–º—É –º—ñ—Å—Ü—ñ",
                search: "–ü–æ—à—É–∫ –±—É–¥—ñ–≤–ª—ñ –∞–±–æ —Ç–æ–≤–∞—Ä—É...",
                lvl: "–†—ñ–≤.",
                price: "–¶—ñ–Ω–∞",
                build: "–ë—É–¥—ñ–≤–Ω–∏—Ü—Ç–≤–æ",
                exp: "–î–æ—Å–≤—ñ–¥",
                time: "–ß–∞—Å",
                extra: "–Ü–Ω—Ñ–æ",
                empty: "–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ üöú",
                close: "OK",
                products: "–ü—Ä–æ–¥—É–∫—Ü—ñ—è",
                ing_details: "–î–µ—Ç–∞–ª—ñ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∞"
            }
        };

        const rawBuildings = [
            { id: 1, ru: "–ü–µ–∫–∞—Ä–Ω—è", en: "Bakery", uk: "–ü–µ–∫–∞—Ä–Ω—è", lvl: 2, price: 20, time: "10—Å", exp: 3, extra: "3—Ö3, 2 —Å–ª–æ—Ç–∞, —É—Å–∫–æ—Ä: 1üíé", icon: "ü•ñ" },
            { id: 2, ru: "–î—Ä–æ–±–∏–ª–∫–∞ (–ö–æ—Ä–º–æ–∑–∞–≤–æ–¥)", en: "Feed Mill", uk: "–î—Ä–æ–±–∞—Ä–∫–∞", lvl: "3 / 12", price: "5 / 3200", time: "40—Å", exp: 4, extra: "–î–µ–ª–∞–µ—Ç –∫–æ—Ä–º", icon: "üöú" },
            { id: 3, ru: "–ú–æ–ª–æ–∫–æ–∑–∞–≤–æ–¥", en: "Dairy Press", uk: "–ú–æ–ª–æ–∫–æ–∑–∞–≤–æ–¥", lvl: 6, price: 50, time: "2—á", exp: 8, extra: "–°–ª–∏–≤–∫–∏, –º–∞—Å–ª–æ, —Å—ã—Ä", icon: "üßÄ" },
            { id: 4, ru: "–°–∞—Ö–∞—Ä–Ω—ã–π –∑–∞–≤–æ–¥", en: "Sugar Mill", uk: "–¶—É–∫—Ä–æ–≤–∏–π –∑–∞–≤–æ–¥", lvl: "7 / 76", price: "350 / 200k", time: "6—á", exp: 12, extra: "–°–∞—Ö–∞—Ä –∏ —Å–∏—Ä–æ–ø", icon: "üç¨" },
            { id: 5, ru: "–ü–æ–ø–∫–æ—Ä–Ω–∏—Ü–∞", en: "Popcorn Pot", uk: "–ü–æ–ø–∫–æ—Ä–Ω–∏—Ü—è", lvl: 8, price: 650, time: "8—á", exp: 14, extra: "–†–∞–∑–Ω—ã–µ –≤–∫—É—Å—ã", icon: "üçø" },
            { id: 6, ru: "–ì—Ä–∏–ª—å", en: "BBQ Grill", uk: "–ì—Ä–∏–ª—å", lvl: 9, price: 730, time: "8—á", exp: 14, extra: "–ë–ª–∏–Ω—ã, –±–µ–∫–æ–Ω, —Ä—ã–±–∞", icon: "üç≥" },
            { id: 7, ru: "–ü–µ—á—å –¥–ª—è –ø–∏—Ä–æ–≥–æ–≤", en: "Pie Oven", uk: "–ü—ñ—á –¥–ª—è –ø–∏—Ä–æ–≥—ñ–≤", lvl: 14, price: 2200, time: "12—á", exp: 17, extra: "–¢—ã–∫–≤–µ–Ω–Ω—ã–π, —è–±–ª–æ—á–Ω—ã–π...", icon: "ü•ß" },
            { id: 8, ru: "–¢–∫–∞—Ü–∫–∏–π —Å—Ç–∞–Ω–æ–∫", en: "Loom", uk: "–¢–∫–∞—Ü—å–∫–∏–π —Å—Ç–∞–Ω–æ–∫", lvl: 17, price: 3200, time: "1–¥", exp: 24, extra: "–°–≤–∏—Ç–µ—Ä–∞, —à–∞–ø–∫–∏", icon: "üß∂" },
            { id: 9, ru: "–®–≤–µ–π–Ω–∞—è –º–∞—à–∏–Ω–∞", en: "Sewing Machine", uk: "–®–≤–µ–π–Ω–∞ –º–∞—à–∏–Ω–∞", lvl: 19, price: 4500, time: "20—á", exp: 24, extra: "–ü–ª–∞—Ç—å—è, —à—Ç–∞–Ω—ã", icon: "üëó" },
            { id: 10, ru: "–ü–µ—á—å –¥–ª—è —Ç–æ—Ä—Ç–æ–≤", en: "Cake Oven", uk: "–ü—ñ—á –¥–ª—è —Ç–æ—Ä—Ç—ñ–≤", lvl: 21, price: 12100, time: "1–¥", exp: 24, extra: "–ö—Ä–∞—Å–Ω—ã–π –±–∞—Ä—Ö–∞—Ç...", icon: "üéÇ" },
            { id: 11, ru: "–ü–ª–∞–≤–∏–ª—å–Ω—è", en: "Smelter", uk: "–ü–ª–∞–≤–∏–ª—å–Ω—è", lvl: 24, price: "12500 - 50500", time: "18—á", exp: 21, extra: "1—è:12.5k, 2—è:22k, 3—è:31.5k, 4—è:41k, 5—è:50.5k", icon: "üî•" },
            { id: 12, ru: "–°–æ–∫–æ–≤—ã–∂–∏–º–∞–ª–∫–∞", en: "Juice Press", uk: "–°–æ–∫–æ–≤–∏—Ç–∏—Å–∫–∞—á", lvl: 26, price: 31000, time: "1–¥ 8—á", exp: 27, extra: "–°–≤–µ–∂–∏–µ —Å–æ–∫–∏", icon: "üçπ" },
            { id: 13, ru: "–°—Ç–∞–Ω–æ–∫ –¥–ª—è –ø—Ä–∏–º–∞–Ω–æ–∫", en: "Lure Workbench", uk: "–í–µ—Ä—Å—Ç–∞—Ç –¥–ª—è –ø—Ä–∏–º–∞–Ω–æ–∫", lvl: 27, price: 0, time: "–ü–æ—Å—Ç—Ä–æ–µ–Ω–æ", exp: 0, extra: "–†—ã–±–æ–ª–æ–≤–Ω–∞—è –∑–æ–Ω–∞", icon: "üé£" },
            { id: 14, ru: "–ú–æ—Ä–æ–∂–µ–Ω–∏—Ü–∞", en: "Ice Cream Maker", uk: "–ú–æ—Ä–æ–∑–∏–≤–æ", lvl: 29, price: 38000, time: "1–¥ 8—á", exp: 27, extra: "–í–∞–Ω–∏–ª—å–Ω–æ–µ, –≤–∏—à–Ω–µ–≤–æ–µ", icon: "üç¶" },
            { id: 15, ru: "–í—è–∑–∞–ª—å—â–∏–∫ —Å–µ—Ç–µ–π", en: "Net Maker", uk: "–í'—è–∑–∞–ª—å–Ω–∏–∫ —Å—ñ—Ç–æ–∫", lvl: 30, price: 28000, time: "2–¥", exp: 32, extra: "–î–ª—è –æ–∑–µ—Ä–∞", icon: "üï∏Ô∏è" },
            { id: 16, ru: "–í–∞—Ä–µ–Ω—å–µ–≤–∞—Ä–∫–∞", en: "Jam Maker", uk: "–í–∞—Ä–µ–Ω–Ω—è–≤–∞—Ä–∫–∞", lvl: 35, price: 59000, time: "1–¥ 12—á", exp: 28, extra: "–î–æ–ª–≥–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ", icon: "üçì" },
            { id: 17, ru: "–Æ–≤–µ–ª–∏—Ä", en: "Jeweler", uk: "–Æ–≤–µ–ª—ñ—Ä", lvl: 38, price: 68000, time: "1–¥ 12—á", exp: 28, extra: "–ö–æ–ª—å—Ü–∞, –æ–∂–µ—Ä–µ–ª—å—è", icon: "üíç" },
            { id: 18, ru: "–ú–µ–¥–æ–≥–æ–Ω–∫–∞", en: "Honey Extractor", uk: "–ú–µ–¥–æ–≥–æ–Ω–∫–∞", lvl: 39, price: 35000, time: "1–¥", exp: 24, extra: "–ú–µ–¥ –∏ –≤–æ—Å–∫", icon: "üçØ" },
            { id: 19, ru: "–ö–æ—Ñ–µ–π–Ω—ã–π –∫–∏–æ—Å–∫", en: "Coffee Kiosk", uk: "–ö–∞–≤–æ–≤–∏–π –∫—ñ–æ—Å–∫", lvl: 42, price: 75000, time: "1–¥ 11—á", exp: 35, extra: "–õ–∞—Ç—Ç–µ, –ú–æ–∫–∫–æ", icon: "‚òï" },
            { id: 20, ru: "–°—É–ø–æ–≤–∞—è –∫—É—Ö–Ω—è", en: "Soup Kitchen", uk: "–°—É–ø–æ–≤–∞ –∫—É—Ö–Ω—è", lvl: 46, price: 115000, time: "1–¥ 12—á", exp: 28, extra: "–ì–æ—Ä—è—á–∏–µ —Å—É–ø—ã", icon: "üç≤" },
            { id: 21, ru: "–°–≤–µ—á–Ω–∏–∫", en: "Candle Maker", uk: "–°–≤—ñ—á–Ω–∏–∫", lvl: 48, price: 118000, time: "1–¥ 14—á", exp: 24, extra: "–ê—Ä–æ–º–∞ —Å–≤–µ—á–∏", icon: "üïØÔ∏è" },
            { id: 22, ru: "–¶–≤–µ—Ç–æ—á–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω", en: "Flower Shop", uk: "–ö–≤—ñ—Ç–∫–æ–≤–∏–π –º–∞–≥–∞–∑–∏–Ω", lvl: 49, price: 120000, time: "1–¥ 16—á", exp: 30, extra: "–ë—É–∫–µ—Ç—ã", icon: "üíê" },
            { id: 23, ru: "–ö–æ–Ω—Ñ–µ—Ç–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç", en: "Candy Machine", uk: "–¶—É–∫–µ—Ä–∫–æ–≤–∏–π –∞–≤—Ç–æ–º–∞—Ç", lvl: 51, price: 120000, time: "1–¥", exp: 27, extra: "–°–ª–∞–¥–æ—Å—Ç–∏", icon: "üç≠" },
            { id: 24, ru: "–°–æ—É—Å–æ–≤–∞—Ä–Ω—è", en: "Sauce Maker", uk: "–°–æ—É—Å–æ–≤–∞—Ä–Ω—è", lvl: 54, price: 135000, time: "1–¥ 16—á", exp: 30, extra: "–ú–∞–π–æ–Ω–µ–∑, —Å–æ—É—Å", icon: "üç∂" },
            { id: 25, ru: "–°—É—à–∏-–±–∞—Ä", en: "Sushi Bar", uk: "–°—É—à—ñ-–±–∞—Ä", lvl: 56, price: 150000, time: "1–¥ 20—á", exp: 38, extra: "–ù–∏–≥–∏—Ä–∏, —Ä–æ–ª–ª—ã", icon: "üç£" },
            { id: 26, ru: "–°–∞–ª–∞—Ç–Ω—ã–π –±–∞—Ä", en: "Salad Bar", uk: "–°–∞–ª–∞—Ç–Ω–∏–π –±–∞—Ä", lvl: 58, price: 165000, time: "2–¥", exp: 32, extra: "–û–≤–æ—â–Ω—ã–µ —Å–∞–ª–∞—Ç—ã", icon: "ü•ó" },
            { id: 27, ru: "–ë—É—Ç–µ—Ä–±—Ä–æ–¥–Ω–∞—è", en: "Sandwich Bar", uk: "–ë—É—Ç–µ—Ä–±—Ä–æ–¥–Ω–∞", lvl: 61, price: 180000, time: "2–¥ 4—á", exp: 34, extra: "–¢–æ—Å—Ç—ã, –ø–∞–Ω–∏–Ω–∏", icon: "ü•™" },
            { id: 28, ru: "–°–º—É–∑–∏-–º–∞—à–∏–Ω–∞", en: "Smoothie Mixer", uk: "–°–º—É–∑—ñ-–º–∞—à–∏–Ω–∞", lvl: 64, price: 220000, time: "3–¥", exp: 39, extra: "–Ø–≥–æ–¥–Ω—ã–µ –º–∏–∫—Å—ã", icon: "ü•§" },
            { id: 29, ru: "–ú–∞—à–∏–Ω–∫–∞ –¥–ª—è –ª–∞–ø—à–∏", en: "Pasta Maker", uk: "–ú–∞—à–∏–Ω–∫–∞ –¥–ª—è –ª–æ–∫—à–∏–Ω–∏", lvl: 67, price: 400000, time: "3–¥ 7—á", exp: 43, extra: "–õ–∞–∑–∞–Ω—å—è, –≥–Ω–æ—á—á–∏", icon: "üçù" },
            { id: 30, ru: "–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –º–∞—Å–µ–ª", en: "Preservation Station", uk: "–õ–∞–±–æ—Ä–∞—Ç–æ—Ä—ñ—è –æ–ª—ñ–π", lvl: 68, price: 85000, time: "3–¥ 8—á", exp: 44, extra: "–§—Ä—É–∫—Ç–æ–≤—ã–µ –∑–∞–≥–æ—Ç–æ–≤–∫–∏", icon: "ü•´" },
            { id: 31, ru: "–í–æ–∫-–∫—É—Ö–Ω—è", en: "Wok Kitchen", uk: "–í–æ–∫-–∫—É—Ö–Ω—è", lvl: 69, price: 350000, time: "3–¥ 8—á", exp: 41, extra: "–°—Ç–∏—Ä-—Ñ—Ä–∞–π", icon: "üç±" },
            { id: 32, ru: "–®–ª—è–ø–Ω–∏–∫", en: "Hat Maker", uk: "–ö–∞–ø–µ–ª—é—à–Ω–∏–∫", lvl: 70, price: 260000, time: "3–¥ 4—á", exp: 40, extra: "–¶–∏–ª–∏–Ω–¥—Ä—ã, –ø–∞–Ω–∞–º—ã", icon: "üé©" },
            { id: 33, ru: "–ú–∞–∫–∞—Ä–æ–Ω–Ω–∞—è –∫—É—Ö–Ω—è", en: "Pasta Kitchen", uk: "–ú–∞–∫–∞—Ä–æ–Ω–Ω–∞ –∫—É—Ö–Ω—è", lvl: 72, price: 550000, time: "3–¥ 12—á", exp: 42, extra: "–§—É–∑–∏–ª–ª–∏, —Ä–∞–≤–∏–æ–ª–∏", icon: "ü•ü" },
            { id: 34, ru: "–ö–∏–æ—Å–∫ —Ö–æ—Ç-–¥–æ–≥–æ–≤", en: "Hot Dog Stand", uk: "–ö—ñ–æ—Å–∫ —Ö–æ—Ç-–¥–æ–≥—ñ–≤", lvl: 75, price: 650000, time: "3–¥ 16—á", exp: 41, extra: "–†–∞–∑–Ω—ã–µ —Å–æ—Å–∏—Å–∫–∏", icon: "üå≠" },
            { id: 35, ru: "–ü–æ–Ω—á–∏–∫–æ–≤–∞—è", en: "Donut Maker", uk: "–ü–æ–Ω—á–∏–∫–æ–≤–∞", lvl: 76, price: 680000, time: "3–¥ 18—á", exp: 42, extra: "–ì–ª–∞–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–Ω—á–∏–∫–∏", icon: "üç©" },
            { id: 36, ru: "–¢–∞–∫–æ-–∫—É—Ö–Ω—è", en: "Taco Kitchen", uk: "–¢–∞–∫–æ-–∫—É—Ö–Ω—è", lvl: 77, price: 700000, time: "3–¥ 18—á", exp: 43, extra: "–û—Å—Ç—Ä–∞—è –µ–¥–∞", icon: "üåÆ" },
            { id: 37, ru: "–û–º–ª–µ—Ç–Ω–∏—Ü–∞", en: "Omelet Station", uk: "–û–º–ª–µ—Ç–Ω–∏—Ü—è", lvl: 77, price: 600000, time: "3–¥ 8—á", exp: 41, extra: "–ó–∞–≤—Ç—Ä–∞–∫–∏", icon: "üç≥" },
            { id: 38, ru: "–ß–∞–π–Ω–∞—è", en: "Tea Stand", uk: "–ß–∞–π–Ω–∞", lvl: 80, price: 750000, time: "3–¥ 23—á", exp: 44, extra: "–ó–µ–ª–µ–Ω—ã–π, —á–µ—Ä–Ω—ã–π —á–∞–π", icon: "üçµ" },
            { id: 39, ru: "–§–æ–Ω–¥—é—à–Ω–∏—Ü–∞", en: "Fondue Pot", uk: "–§–æ–Ω–¥—é—à–Ω–∏—Ü—è", lvl: 81, price: 800000, time: "4–¥", exp: 44, extra: "–°—ã—Ä–Ω–æ–µ, —à–æ–∫–æ–ª–∞–¥–Ω–æ–µ", icon: "ü´ï" },
            { id: 40, ru: "–ú—ã–ª–æ–≤–∞—Ä–Ω—è", en: "Bath Kiosk", uk: "–ú–∏–ª–æ–≤–∞—Ä–Ω—è", lvl: 84, price: 850000, time: "4–¥", exp: 44, extra: "–ú—ã–ª–æ, –ª–æ—Å—å–æ–Ω—ã", icon: "üßº" },
            { id: 41, ru: "–§—Ä–∏—Ç—é—Ä–Ω–∏—Ü–∞", en: "Deep Fryer", uk: "–§—Ä–∏—Ç—é—Ä–Ω–∏—Ü—è", lvl: 87, price: 900000, time: "4–¥", exp: 44, extra: "–ö–∞—Ä—Ç–æ—à–∫–∞ —Ñ—Ä–∏", icon: "üçü" },
            { id: 42, ru: "–ö–æ–Ω—Å–µ—Ä–≤–Ω—ã–π –∑–∞–≤–æ–¥", en: "Stew Pot", uk: "–ö–æ–Ω—Å–µ—Ä–≤–Ω–∏–π –∑–∞–≤–æ–¥", lvl: 91, price: 950000, time: "4–¥", exp: 44, extra: "–¢—É—à–µ–Ω–∫–∞", icon: "ü•©" },
            { id: 43, ru: "–ì–æ–Ω—á–∞—Ä–Ω–∞—è –ø–µ—á—å", en: "Pottery Studio", uk: "–ì–æ–Ω—á–∞—Ä–Ω–∞ –ø—ñ—á", lvl: 94, price: 1000000, time: "4–¥", exp: 46, extra: "–í–∞–∑—ã, –∫—Ä—É–∂–∫–∏", icon: "üè∫" },
            { id: 44, ru: "–ú–∞–≥–∞–∑–∏–Ω –∏—Ä–∏—Å–∞", en: "Fudge Shop", uk: "–ú–∞–≥–∞–∑–∏–Ω —ñ—Ä–∏—Å—É", lvl: 99, price: 1050000, time: "4–¥", exp: 44, extra: "–ò—Ä–∏—Å–∫–∏", icon: "üç´" },
            { id: 45, ru: "–ô–æ–≥—É—Ä—Ç–Ω–∏—Ü–∞", en: "Yogurt Maker", uk: "–ô–æ–≥—É—Ä—Ç–Ω–∏—Ü—è", lvl: 103, price: 1100000, time: "4–¥", exp: 44, extra: "–§—Ä—É–∫—Ç–æ–≤—ã–π –π–æ–≥—É—Ä—Ç", icon: "üç®" },
            { id: 46, ru: "–†–∞–≥—É—à–Ω–∏—Ü–∞", en: "Stew Maker", uk: "–†–∞–≥—É—à–Ω–∏—Ü—è", lvl: 106, price: 1150000, time: "4–¥", exp: 44, extra: "–ú—è—Å–Ω–æ–µ —Ä–∞–≥—É", icon: "ü•ò" },
            { id: 47, ru: "–ö–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∞—è", en: "Cupcake Maker", uk: "–ö–æ–Ω–¥–∏—Ç–µ—Ä—Å—å–∫–∞", lvl: 109, price: 1200000, time: "4–¥", exp: 44, extra: "–ö–∞–ø–∫–µ–π–∫–∏", icon: "üßÅ" },
            { id: 48, ru: "–ü–∞—Ä—Ñ—é–º–µ—Ä–Ω–∞—è", en: "Perfume Maker", uk: "–ü–∞—Ä—Ñ—É–º–µ—Ä–Ω–∞", lvl: 110, price: 1000000, time: "4–¥", exp: 44, extra: "–î—É—Ö–∏", icon: "üß™" },
            { id: 49, ru: "–í–∞—Ñ–µ–ª—å–Ω–∏—Ü–∞", en: "Waffle Maker", uk: "–í–∞—Ñ–µ–ª—å–Ω–∏—Ü—è", lvl: 114, price: 1250000, time: "4–¥", exp: 44, extra: "–ë–µ–ª—å–≥–∏–π—Å–∫–∏–µ –≤–∞—Ñ–ª–∏", icon: "üßá" },
            { id: 50, ru: "–ö–∞—à–µ–≤–∞—Ä–Ω—è", en: "Porridge Maker", uk: "–ö–∞—à–µ–≤–∞—Ä–Ω—è", lvl: 119, price: 1300000, time: "4–¥", exp: 44, extra: "–ó–¥–æ—Ä–æ–≤—ã–π –∑–∞–≤—Ç—Ä–∞–∫", icon: "ü•£" },
            { id: 51, ru: "–ú–∏–ª–∫—à–µ–π–∫-–±–∞—Ä", en: "Milkshake Bar", uk: "–ú—ñ–ª–∫—à–µ–π–∫-–±–∞—Ä", lvl: 124, price: 1350000, time: "4–¥", exp: 44, extra: "–ö–æ–∫—Ç–µ–π–ª–∏", icon: "ü•§" }
        ];

        // –ë–∞–∑–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (–ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω—è—Ç—å)
        const products = {
            1: [ // Bakery
                { name: {ru: "–•–ª–µ–±", en: "Bread", uk: "–•–ª—ñ–±"}, lvl: 2, price: 21, diamonds: 1, exp: 3, ing: ["3 –ø—à–µ–Ω–∏—Ü—ã"] },
                { name: {ru: "–ü–∏—Ü—Ü–∞", en: "Pizza", uk: "–ü—ñ—Ü–∞"}, lvl: 33, price: 190, diamonds: 3, exp: 23, ing: ["2 –ø—à–µ–Ω–∏—Ü—ã", "1 –ø–æ–º–∏–¥–æ—Ä", "1 —Å—ã—Ä"] },
                { name: {ru: "", en: "Pizza", uk: "–ü—ñ—Ü–∞"}, lvl: 33, price: 190, diamonds: 3, exp: 23, ing: ["2 –ø—à–µ–Ω–∏—Ü—ã", "1 –ø–æ–º–∏–¥–æ—Ä", "1 —Å—ã—Ä"] }
            ]
        };

        const resources = {
            ru: {
                "–ø—à–µ–Ω–∏—Ü—ã": { lvl: 1, price: 3, time: "2 –º–∏–Ω", exp: 1, icon: "üåæ", name: "–ü—à–µ–Ω–∏—Ü–∞" },
                "–ø–æ–º–∏–¥–æ—Ä": { lvl: 30, price: 13, time: "6 —á", exp: 12, icon: "üçÖ", name: "–ü–æ–º–∏–¥–æ—Ä" },
                "—Å—ã—Ä": { lvl: 12, price: 122, time: "1 —á", exp: 15, icon: "üßÄ", name: "–°—ã—Ä" }
            },
            en: {
                "wheat": { lvl: 1, price: 3, time: "2 min", exp: 1, icon: "üåæ", name: "Wheat" }
            },
            uk: {
                "–ø—à–µ–Ω–∏—Ü—ñ": { lvl: 1, price: 3, time: "2 —Ö–≤", exp: 1, icon: "üåæ", name: "–ü—à–µ–Ω–∏—Ü—è" }
            }
        };

        function changeLang(lang) {
            currentLang = lang;
            document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${lang}`).classList.add('active');
            
            document.getElementById('ui-title').innerText = i18n[lang].title;
            document.getElementById('ui-subtitle').innerText = i18n[lang].subtitle;
            document.getElementById('search-input').placeholder = i18n[lang].search;
            
            handleSearch();
        }

        function renderBuildings(list) {
            const grid = document.getElementById('buildings-grid');
            grid.innerHTML = '';
            
            if (list.length === 0) {
                grid.innerHTML = `<div class="col-span-full text-center py-10 text-amber-800 font-bold">${i18n[currentLang].empty}</div>`;
                return;
            }

            list.forEach((b) => {
                const card = document.createElement('div');
                card.className = "farm-card bg-white rounded-3xl p-5 flex flex-col items-center text-center shadow-sm";
                card.onclick = () => openBuilding(b.id);
                card.innerHTML = `
                    <div class="text-5xl mb-3">${b.icon}</div>
                    <h2 class="text-lg font-black mb-1 line-clamp-1">${b[currentLang]}</h2>
                    <div class="flex flex-wrap justify-center gap-1 mt-1">
                        <span class="stat-badge badge-lvl">${i18n[currentLang].lvl} ${b.lvl}</span>
                        <span class="stat-badge badge-coin">${b.price} üí∞</span>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function handleSearch() {
            const query = document.getElementById('search-input').value.toLowerCase();
            const filtered = rawBuildings.filter(b => 
                b.ru.toLowerCase().includes(query) || 
                b.en.toLowerCase().includes(query) || 
                b.uk.toLowerCase().includes(query)
            );
            renderBuildings(filtered);
        }

        function openBuilding(id) {
            const b = rawBuildings.find(x => x.id === id);
            const modal = document.getElementById('modal');
            const modalBody = document.getElementById('modal-body');
            
            const prodList = products[id] || [];

            modalBody.innerHTML = `
                <div class="flex items-center gap-4 mb-4 border-b-2 border-amber-100 pb-4">
                    <div class="text-5xl">${b.icon}</div>
                    <div>
                        <h2 class="text-2xl font-black text-amber-900">${b[currentLang]}</h2>
                        <div class="flex flex-wrap gap-2 mt-1">
                            <span class="stat-badge badge-time">‚è± ${b.time}</span>
                            <span class="stat-badge badge-extra">‚ÑπÔ∏è ${b.extra}</span>
                        </div>
                    </div>
                </div>
                <h3 class="font-bold text-amber-800 mb-3">${i18n[currentLang].products}</h3>
                <div class="space-y-3">
                    ${prodList.length > 0 ? prodList.map(item => `
                        <div class="item-row pb-3">
                            <div class="flex flex-col gap-1">
                                <div class="flex justify-between">
                                    <span class="font-bold text-amber-900">${item.name[currentLang]}</span>
                                    <span class="stat-badge badge-coin">${item.price} üí∞</span>
                                </div>
                                <div class="flex flex-wrap gap-1 text-[10px]">
                                    <span class="stat-badge badge-lvl">Lvl ${item.lvl}</span>
                                    <span class="stat-badge badge-extra">üíé ${item.diamonds}</span>
                                    <span class="stat-badge badge-lvl">‚ú® ${item.exp}</span>
                                </div>
                                <div class="flex flex-wrap gap-1 mt-1">
                                    ${item.ing.map(ing => `<span class="ingredient" onclick="showIngredientInfo('${ing}')">${ing}</span>`).join('')}
                                </div>
                            </div>
                        </div>
                    `).join('') : `<p class="text-sm text-amber-500 italic">... (–ü—Ä–æ–¥—É–∫—Ü–∏—è —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞)</p>`}
                </div>
            `;
            modal.style.display = 'flex';
            setTimeout(() => modal.classList.add('active'), 10);
            document.body.style.overflow = 'hidden';
        }

        function showIngredientInfo(ingString) {
            const subModal = document.getElementById('sub-modal');
            const subBody = document.getElementById('sub-modal-body');
            
            const parts = ingString.toLowerCase().trim().split(' ');
            let key = parts.length > 1 ? parts.slice(1).join(' ') : parts[0];
            
            let res = resources[currentLang][key] || resources['ru'][key];

            if (res) {
                subBody.innerHTML = `
                    <div class="text-5xl mb-2">${res.icon}</div>
                    <h4 class="text-xl font-black text-amber-900 mb-3">${res.name}</h4>
                    <div class="space-y-1 text-sm text-left">
                        <div class="flex justify-between p-2 bg-white rounded-lg"><span>${i18n[currentLang].lvl}:</span> <b>${res.lvl}</b></div>
                        <div class="flex justify-between p-2 bg-white rounded-lg"><span>${i18n[currentLang].price}:</span> <b>${res.price} üí∞</b></div>
                        <div class="flex justify-between p-2 bg-white rounded-lg"><span>${i18n[currentLang].time}:</span> <b>${res.time}</b></div>
                        <div class="flex justify-between p-2 bg-white rounded-lg"><span>${i18n[currentLang].exp}:</span> <b>${res.exp} ‚ú®</b></div>
                    </div>
                    <button onclick="closeSubModal()" class="mt-4 w-full bg-amber-600 text-white py-3 rounded-2xl font-bold">${i18n[currentLang].close}</button>
                `;
            } else {
                subBody.innerHTML = `<div class="p-4"><p class="font-bold">${ingString}</p><p class="text-sm text-amber-600">–î–µ—Ç–∞–ª–∏ —Å–∫–æ—Ä–æ...</p></div><button onclick="closeSubModal()" class="mt-2 w-full bg-amber-600 text-white py-2 rounded-xl">OK</button>`;
            }

            subModal.style.display = 'flex';
            setTimeout(() => subModal.classList.add('active'), 10);
        }

        function closeModal(e) {
            if (e && e.target !== document.getElementById('modal')) return;
            const modal = document.getElementById('modal');
            modal.classList.remove('active');
            setTimeout(() => { modal.style.display = 'none'; document.body.style.overflow = 'auto'; }, 300);
        }

        function closeSubModal() {
            const subModal = document.getElementById('sub-modal');
            subModal.classList.remove('active');
            setTimeout(() => { subModal.style.display = 'none'; }, 300);
        }

        window.onload = () => changeLang('ru');
    </script>
</body>
</html>
